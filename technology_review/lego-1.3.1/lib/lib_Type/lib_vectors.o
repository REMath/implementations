Module lib_vectors Import "lib_finite" "lib_list_length";
$[vect : {A:Type}{n:nat}Type(vect)//vnil vcons];
$[vnil : {A:Type}vect A zero];
$[vcons : {A|Type}{a:A}{n|nat}{v:vect A n}vect A (suc n)];
$[vect_elim : {A|Type}{C_vect:{n|nat}(vect A n)->Type}(C_vect%%zero (vnil A))->({a:A}{n|nat}{v:vect A n}{v_ih:C_vect%%n v}C_vect%%(suc n) (vcons%%A a%%n v))->{n|nat}{z:vect A n}C_vect%%n z];
Label (!vect!) vect;Label (!vect elim!) vect_elim;Label (!vect vnil!) vnil;Label (!vect vcons!) vcons;[[A|Type][C_vect:{n|nat}(vect A n)->Type][f_vnil:C_vect (vnil A)][f_vcons:{a:A}{n|nat}{v:vect A n}(C_vect v)->C_vect (vcons a v)][a:A][n|nat][v:vect A n]   vect_elim C_vect f_vnil f_vcons (vnil A)  ==>  f_vnil|| vect_elim C_vect f_vnil f_vcons (vcons a v)  ==>  f_vcons a v (vect_elim C_vect f_vnil f_vcons v)]
;
[vect_elim_ne : {A|Type}{C:{n|nat}{v:vect A (suc n)}Type}{vect_elim_ne_prem:{a:A}{n|nat}{v:vect A n}C%%n (vcons%%A a%%n v)}{n|nat}{v:vect A (suc n)}C%%n v
  = [A|Type][C:{n|nat}{v:vect A (suc n)}Type][vect_elim_ne_prem:{a:A}{n|nat}{v:vect A n}C%%n (vcons%%A a%%n v)][vect_elim_ne_C=nat_elim ([n:nat]{v:vect A n}Type) ([v:vect A zero]trueProp) ([x1:nat][x1_ih:{v:vect A x1}Type][v:vect A (suc x1)]C%%x1 v)][n|nat][v:vect A (suc n)]vect_elim%%A vect_elim_ne_C ([P:Prop][H:P]H) ([a:A][n1|nat][v1:vect A n1][v_ih:vect_elim_ne_C%%n1 v1]vect_elim_ne_prem a%%n1 v1)%%(suc n) v];
[vect_elim'_lemma : {A|Type}{n:nat}{m:vect A (suc n)}{P:(vect A (suc n))->Type}({a:A}{m'6:vect A n}P (vcons%%A a%%n m'6))->P m
  = [A|Type][n:nat]vect_elim%%A (nat_elim ([x:nat](vect A x)->Type) ([_:vect A zero]trueProp) ([x|nat][_:(vect A x)->Type][n'5=suc x][m:vect A n'5]{P:(vect A n'5)->Type}({a:A}{m'9:vect A x}P (vcons%%A a%%x m'9))->P m)) ([P:Prop][H:P]H) ([a:A][n1|nat][v:vect A n1][v_ih:nat_elim ([x:nat](vect A x)->Type) ([_:vect A zero]trueProp) ([x|nat][_:(vect A x)->Type][n'8=suc x][m:vect A n'8]{P:(vect A n'8)->Type}({a'11:A}{m'12:vect A x}P (vcons%%A a'11%%x m'12))->P m)%%n1 v][P:(vect A (suc n1))->Type][H:{a'8:A}{m:vect A n1}P (vcons%%A a'8%%n1 m)]H a v)%%(suc n)];
[vect_rec : {A|Type}{C|Type}C->({a:A}{n|nat}{v:vect A n}{v_ih:C}C)->{n|nat}{z:vect A n}C
  = [A|Type][C|Type]vect_elim%%A ([n|nat][_:vect A n]C)];
[vect_iter : {A|Type}{C|Type}{a:C}{f:nat->A->C->C}{n|nat}{z:vect A n}C
  = [A|Type][C|Type][a:C][f:nat->A->C->C]vect_rec%%A%%C a ([x:A][n|nat][_:vect A n]f n x)];
[vect_ind : {A|Type}{P:{n:nat}(vect A n)->Prop}(P%%zero (vnil A))->({a:A}{n|nat}{v:vect A n}{v_ih:P%%n v}P%%(suc n) (vcons%%A a%%n v))->{n|nat}{z:vect A n}P%%n z
  = [A|Type][P:{n:nat}(vect A n)->Prop]vect_elim%%A P];
[vnil_lemma : {A|Type}{n:nat}{v:vect A n}nat_elim|([x:nat](vect A x)->Prop) ([v'4:vect A zero]Eq%%(vect A zero) v'4 (vnil A)) ([x:nat][_:(vect A x)->Prop][_:vect A (suc x)]trueProp) n v
  = [A|Type]vect_elim%%A ([n|nat]nat_elim|([x:nat](vect A x)->Prop) ([v:vect A zero]Eq%%(vect A zero) v (vnil A)) ([x:nat][_:(vect A x)->Prop][_:vect A (suc x)]trueProp) n) (Eq_refl%%(vect A zero) (vnil A)) ([a:A][n|nat][v:vect A n][v_ih:nat_elim|([x:nat](vect A x)->Prop) ([v'5:vect A zero]Eq%%(vect A zero) v'5 (vnil A)) ([x:nat][_:(vect A x)->Prop][_:vect A (suc x)]trueProp) n v][P:Prop][H:P]H)];
[vect_zero_eq_vnil : {A|Type}{v:vect A zero}Eq%%(vect A zero) v (vnil A)
  = [A|Type][v:vect A zero]vnil_lemma%%A zero v];
[vect_head : {A|Type}{n|nat}{m:vect A (suc n)}A
  = [A|Type]vect_elim_ne%%A ([n|nat][m:vect A (suc n)]A) ([a:A][n|nat][v:vect A n]a)];
[vect_tail : {A|Type}{n|nat}{m:vect A (suc n)}vect A n
  = [A|Type]vect_elim_ne%%A ([n|nat][m:vect A (suc n)]vect A n) ([a:A][n|nat][v:vect A n]v)];
[cons_inj_lemma1 : {A|Type}{a,b:A}{n:nat}{v:vect A n}(Eq%%(vect A (suc n)) (vcons%%A a%%n v) (vcons%%A b%%n v))->Eq%%A a b
  = [A|Type][a,b:A][n:nat][v:vect A n][H:Eq%%(vect A (suc n)) (vcons%%A a%%n v) (vcons%%A b%%n v)]Eq_subst%%(vect A (suc n))%%(vcons%%A a%%n v)%%(vcons%%A b%%n v) H ([x:vect A (suc n)]Eq%%A a (vect_head%%A%%n x)) (Eq_refl%%A a)];
[cons_inj_lemma2 : {A|Type}{a:A}{n:nat}{v,w:vect A n}(Eq%%(vect A (suc n)) (vcons%%A a%%n v) (vcons%%A a%%n w))->Eq%%(vect A n) v w
  = [A|Type][a:A][n:nat][v,w:vect A n][H:Eq%%(vect A (suc n)) (vcons%%A a%%n v) (vcons%%A a%%n w)]Eq_subst%%(vect A (suc n))%%(vcons%%A a%%n v)%%(vcons%%A a%%n w) H ([x:vect A (suc n)]Eq%%(vect A n) v (vect_tail%%A%%n x)) (Eq_refl%%(vect A n) v)];
[vect_head_cons_tail : {A|Type}{n|nat}{v:vect A (suc n)}Eq%%(vect A (suc n)) (vcons%%A (vect_head%%A%%n v)%%n (vect_tail%%A%%n v)) v
  = [A|Type][n|nat][v:vect A (suc n)]vect_elim'_lemma%%A n v ([v'4:vect A (suc n)]Eq%%(vect A (suc n)) (vcons%%A (vect_head%%A%%n v'4)%%n (vect_tail%%A%%n v'4)) v'4) ([a:A][m:vect A n]Eq_refl%%(vect A (suc n)) (vcons%%A (vect_head%%A%%n (vcons%%A a%%n m))%%n (vect_tail%%A%%n (vcons%%A a%%n m))))];
[vect_nth : {A|Type}{n|nat}{x:fin n}{v:vect A n}A
  = [A|Type]fin_elim ([n|nat][x:fin n]{v:vect A n}A) (vect_head%%A) ([n|nat][x:fin n][x_ih:{v:vect A n}A][v:vect A (suc n)]x_ih (vect_tail%%A%%n v))];
[vect_update : {A|Type}{n|nat}{x:fin n}{v:vect A n}{t:A}vect A n
  = [A|Type]fin_elim ([n|nat][x:fin n]{v:vect A n}{t:A}vect A n) ([n:nat][v:vect A (suc n)][t:A]vcons%%A t%%n (vect_tail%%A%%n v)) ([n|nat][x:fin n][x_ih:{v:vect A n}{t:A}vect A n][v:vect A (suc n)][t:A]vcons%%A (vect_head%%A%%n v)%%n (x_ih (vect_tail%%A%%n v) t))];
[vect_character : {A:Type}[vect_character_rhs=nat_elim ([n:nat]{v:vect A n}vect A n) ([v:vect A zero]vnil A) ([x1:nat][x1_ih:{v:vect A x1}vect A x1][v:vect A (suc x1)]vcons%%A (vect_head%%A%%x1 v)%%x1 (vect_tail%%A%%x1 v))]{n|nat}{v:vect A n}Eq%%(vect A n) v (vect_character_rhs n v)
  = [A:Type][vect_character_rhs=nat_elim ([n:nat]{v:vect A n}vect A n) ([v:vect A zero]vnil A) ([x1:nat][x1_ih:{v:vect A x1}vect A x1][v:vect A (suc x1)]vcons%%A (vect_head%%A%%x1 v)%%x1 (vect_tail%%A%%x1 v))]vect_elim%%A ([n|nat][v:vect A n]Eq%%(vect A n) v (vect_character_rhs n v)) (Eq_refl%%(vect A zero) (vnil A)) ([a:A][n|nat][v:vect A n][v_ih:Eq%%(vect A n) v (vect_character_rhs n v)]Eq_refl%%(vect A (suc n)) (vcons%%A a%%n v))];
[vect_zip : {A|Type}{n:nat}{bin:A->A->A}(vect A n)->(vect A n)->vect A n
  = [A|Type][n:nat][bin:A->A->A]nat_elim ([n'4:nat](vect A n'4)->(vect A n'4)->vect A n'4) ([H,H1:vect A zero]vnil A) ([x1:nat][x1_ih:(vect A x1)->(vect A x1)->vect A x1][H,H1:vect A (suc x1)]vcons%%A (bin (vect_head%%A%%x1 H) (vect_head%%A%%x1 H1))%%x1 (x1_ih (vect_tail%%A%%x1 H) (vect_tail%%A%%x1 H1))) n];
[vector_to_list : {A|Type}{n|nat}(vect A n)->list A
  = [A|Type]vect_elim%%A ([n|nat][v:vect A n]list A) (nil A) ([a:A][n|nat][v:vect A n][v_ih:list A]cons|A a v_ih)];
[vector_to_list_resp_cons : {A|Type}{n|nat}{v:vect A n}{a:A}Eq%%(list A) (cons|A a (vector_to_list%%A%%n v)) (vector_to_list%%A%%(suc n) (vcons%%A a%%n v))
  = [A|Type]vect_ind%%A ([n|nat][v:vect A n]{a:A}Eq%%(list A) (cons|A a (vector_to_list%%A%%n v)) (vector_to_list%%A%%(suc n) (vcons%%A a%%n v))) ([a:A]Eq_refl%%(list A) (cons|A a (vector_to_list%%A%%zero (vnil A)))) ([a:A][n|nat][v:vect A n][v_ih:{a'5:A}Eq%%(list A) (cons|A a'5 (vector_to_list%%A%%n v)) (vector_to_list%%A%%(suc n) (vcons%%A a'5%%n v))][a1:A]Eq_resp%%(list A)%%(list A) (cons|A a1)%%(vector_to_list%%A%%(suc n) (vcons%%A a%%n v))%%(vect_elim%%A ([n'7|nat][v'8:vect A n'7]list A) (nil A) ([a'7:A][n'8|nat][v'9:vect A n'8][v_ih'10:list A]cons|A a'7 v_ih'10)%%(suc n) (vcons%%A a%%n v)) (v_ih a))];
[vect_nth_equiv_nth : {A|Type}{n|nat}{x:fin n}{v:vect A n}{a:A}Eq%%A (vect_nth%%A%%n x v) (nth (fin_to_nat%%n x)%%A (vector_to_list%%A%%n v) a)
  = [A|Type][n|nat]nat_ind ([n'3:nat]{x:fin n'3}{v:vect A n'3}{a:A}Eq%%A (vect_nth%%A%%n'3 x v) (nth (fin_to_nat%%n'3 x)%%A (vector_to_list%%A%%n'3 v) a)) ([x:fin zero][v:vect A zero][a:A]zero_set_is_empty x (Eq%%A (vect_nth%%A%%zero x v) (nth (fin_to_nat%%zero x)%%A (vector_to_list%%A%%zero v) a))) ([n1:nat][H:{x:fin n1}{v:vect A n1}{a:A}Eq%%A (vect_nth%%A%%n1 x v) (nth (fin_to_nat%%n1 x)%%A (vector_to_list%%A%%n1 v) a)][x:fin (suc n1)][v:vect A (suc n1)][a:A]Eq_subst%%(vect A (suc n1))%%(vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))%%v (Eq_sym%%(vect A (suc n1))%%v%%(vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v)) (Eq_sym%%(vect A (suc n1))%%(vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))%%v (vect_head_cons_tail%%A%%n1 v))) ([z:vect A (suc n1)]Eq%%A (vect_nth%%A%%(suc n1) x z) (nth (fin_to_nat%%(suc n1) x)%%A (vector_to_list%%A%%(suc n1) z) a)) (Eq_subst%%(list A)%%(cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v)))%%(vector_to_list%%A%%(suc n1) (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (Eq_sym%%(list A)%%(vector_to_list%%A%%(suc n1) (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v)))%%(cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v))) (Eq_sym%%(list A)%%(cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v)))%%(vector_to_list%%A%%(suc n1) (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (vector_to_list_resp_cons%%A%%n1 (vect_tail%%A%%n1 v) (vect_head%%A%%n1 v)))) ([z:list A]Eq%%A (vect_nth%%A%%(suc n1) x (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (nth (fin_to_nat%%(suc n1) x)%%A z a)) (finite_is_zero_or_succ n1 x%%(Eq%%A (vect_nth%%A%%(suc n1) x (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (nth (fin_to_nat%%(suc n1) x)%%A (cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v))) a)) ([H1:Eq%%(fin (suc n1)) x (f_zero n1)]Eq_subst%%(fin (suc n1))%%(f_zero n1)%%x (Eq_sym%%(fin (suc n1))%%x%%(f_zero n1) H1) ([z:fin (suc n1)]Eq%%A (vect_nth%%A%%(suc n1) z (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (nth (fin_to_nat%%(suc n1) z)%%A (cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v))) a)) (Eq_refl%%A (vect_nth%%A%%(suc n1) (f_zero n1) (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))))) ([H1:Ex%%(fin n1) ([x':fin n1]Eq%%(fin (suc n1)) x (f_suc%%n1 x'))]H1 (Eq%%A (vect_nth%%A%%(suc n1) x (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (nth (fin_to_nat%%(suc n1) x)%%A (cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v))) a)) ([t:fin n1][H2:Eq%%(fin (suc n1)) x (f_suc%%n1 t)]Eq_subst%%(fin (suc n1))%%(f_suc%%n1 t)%%x (Eq_sym%%(fin (suc n1))%%x%%(f_suc%%n1 t) H2) ([z:fin (suc n1)]Eq%%A (vect_nth%%A%%(suc n1) z (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (nth (fin_to_nat%%(suc n1) z)%%A (cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v))) a)) (Eq_subst%%nat%%(suc (fin_to_nat%%n1 t))%%(fin_to_nat%%(suc n1) (f_suc%%n1 t)) (Eq_sym%%nat%%(fin_to_nat%%(suc n1) (f_suc%%n1 t))%%(suc (fin_to_nat%%n1 t)) (Eq_sym%%nat%%(suc (fin_to_nat%%n1 t))%%(fin_to_nat%%(suc n1) (f_suc%%n1 t)) (fin_to_nat_resp_suc%%n1 t))) ([z:nat]Eq%%A (vect_nth%%A%%(suc n1) (f_suc%%n1 t) (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) (nth z%%A (cons|A (vect_head%%A%%n1 v) (vector_to_list%%A%%n1 (vect_tail%%A%%n1 v))) a)) (H t (vect_tail%%A%%n1 (vcons%%A (vect_head%%A%%n1 v)%%n1 (vect_tail%%A%%n1 v))) a))))))) n];
